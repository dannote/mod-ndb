#  Test suite control script for mod_ndb

# run-test[group]  -- where group can be e.g. "ses" or "ses1" or "ses104"
# If group is blank, then run all tests in test.list

# -r means run and record results (in the results/ directory)
# -t means run and compare actual result to recorded result -- Pass or Fail
# -s means run SQL scripts to prepare the test database, instead of actual tests
# -e means just print the commands that would have been executed

[ -d /usr/xpg4/bin ]  && PATH=/usr/xpg4/bin:$PATH

exe="sh"
arg=$1 
while shift
 do
   test "$arg" = "-e" && exe="cat"  
   test "$arg" = "-r" && mode="-v mode=record"
   test "$arg" = "-s" && mode="-v mode=sql"
   test "$arg" = "-t" && mode="-v mode=compare"
   testcase=$arg
   arg=$1
done

awk -f runner.awk -v test=$testcase $mode test.list | $exe
